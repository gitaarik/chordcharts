{% extends "base.html" %}
{% load compress %}

{% block css %}
    <link type="text/less" rel="stylesheet" href="{{ STATIC_URL }}chordcharts/charts.less" />
{% endblock %}

{% block javascript %}

        <script>

            var settings = {
                box_width: {{ settings.box_width }},
                box_height: {{ settings.box_height }},
                border_width: {{ settings.border_width }},
                section_sidebar_width: {{ settings.section_sidebar_width }},
            }

            settings.sections = []

            {% for section in sections %}
                settings.sections.push({
                    height: {{ section.boxed_chart.height }}
                })
            {% endfor %}

        </script>
        <script src="{{ STATIC_URL }}chordcharts/charts.js"></script>

{% endblock %}

{% block content %}

    <article class="chord-chart" style="width: {{ boxed_chart.total_width }}px;">

        <header>

            <h1>{{ song_name }}</h1>

            <div class="key_select" style="margin-left: {{ boxed_chart.section_sidebar_width }}px;">
                <div class="closed">
                    Key of {{ chart_key }}
                </div>
                <div class="open">
                    <ul>
                        <li>F Major</li>
                        <li>D Major</li>
                        <li>G Major</li>
                    </ul>
                </div>
            </div>

        </header>

        <div class="boxed-chart">

            {% for section in sections %}

                <div class="section" style="width: {{ boxed_chart.total_width }}px;">

                    <div class="section-sidebar" style="height: {{ section.boxed_chart.height }}px;">
                        <div class="section-sidebar-title" style="line-height: {{ section.boxed_chart.height }}px;">
                            {{ section.name }}
                        </div>
                    </div>

                    <div class="chord-boxes">

                        <div class="line line-first">

                            {% for box in section.boxed_chart.boxes %}

                                {% if box.starts_on_new_line %}
                                    </div>
                                    <div class="line">
                                {% endif %}

                                <div class="
                                    box
                                    box-beatschema-{{ box.beat_schema }}
                                    {% if forloop.first or box.starts_on_new_line %}
                                        box-first
                                    {% endif %}
                                ">

                                    {% if box.beat_schema == "4" %}
                                        {{ box.parts.0.chord }}
                                    {% endif %}

                                    {% if box.beat_schema == "2-2" %}
                                        <div class="chord-first">{{ box.parts.0.chord }}</div>
                                        <div class="chord-second">{{ box.parts.1.chord }}</div>
                                    {% endif %}

                                    {% if box.beat_schema == "2-1-1" %}
                                        <div class="chord-first">{{ box.parts.0.chord }}</div>
                                        <div class="chord-second">{{ box.parts.1.chord }}</div>
                                        <div class="chord-third">{{ box.parts.2.chord }}</div>
                                    {% endif %}

                                </div>

                            {% endfor %}

                        </div>

                    </div>

                </div>

            {% endfor %}

        </div>

    </article>

{% endblock %}
